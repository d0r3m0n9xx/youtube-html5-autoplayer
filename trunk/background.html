<html>
    <head>
        <script type="text/javascript" src="dojo.js"></script>
        <script type="text/javascript">

            function sendRequest(request, sendResponse) {
                if (request.shuffle) {
                    request.params["shuffle"] = 1
                }
                dojo.xhrGet({
                    url:request.url,
                    content:request.params,
                    handleAs:"text",
                    load:function(response) {
                        sendResponse({
                            playlistInfo:response
                        })
                    },
                    error:function(error) {
                        setTimeout("sendRequest(request, sendResponse)", 1000)
                    },
                    timeout:10000
                })
            }
            chrome.extension.onRequest.addListener(function(request, sender, sendResponse) {
                sendRequest(request, sendResponse)
            })
        </script>
    </head>
</html>